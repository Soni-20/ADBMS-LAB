CREATE DATABASE MOVIESS;
USE MOVIESS;

CREATE TABLE ACTOR(ACT_ID VARCHAR(20) NOT NULL,
					ACT_NAME VARCHAR(20) NOT NULL,
                    ACT_GENDER VARCHAR(20) NOT NULL);
CREATE TABLE DIRECTOR(DIR_ID VARCHAR(20) NOT NULL,
					DIR_NAME VARCHAR(20) NOT NULL,
                    DIR_PHONE INT(10) NOT NULL);
CREATE TABLE MOVIES(MOV_ID VARCHAR(20) NOT NULL,
					MOV_TITLE VARCHAR(20) NOT NULL,
                    MOV_YEAR INT(20) NOT NULL,
                    MOV_LANG INT(10) NOT NULL,
                    DIR_ID VARCHAR(20) NOT NULL);
CREATE TABLE MOVIE_CAST(ACT_ID VARCHAR(20) NOT NULL,
					MOV_ID VARCHAR(20) NOT NULL,
                    ROLE VARCHAR(20) NOT NULL);
INSERT INTO ACTOR(ACT_ID,ACT_NAME,ACT_GENDER )VALUES("1","AA","FEMALE");
INSERT INTO ACTOR(ACT_ID,ACT_NAME,ACT_GENDER )VALUES("2","BB","MALE");
INSERT INTO ACTOR(ACT_ID,ACT_NAME,ACT_GENDER )VALUES("12","ZZ","MALE");
INSERT INTO ACTOR(ACT_ID,ACT_NAME,ACT_GENDER )VALUES("3","CC","FEMALE");

INSERT INTO DIRECTOR(DIR_ID,DIR_NAME,DIR_PHONE )VALUES("4","HITCHCOCK","974789");
INSERT INTO DIRECTOR(DIR_ID,DIR_NAME,DIR_PHONE )VALUES("5","STEVEN SPIELBERG","56789");

INSERT INTO MOVIES(MOV_ID,MOV_TITLE,MOV_YEAR,MOV_LANG,DIR_ID)VALUES("6","DD","1999","MAL","4");
INSERT INTO MOVIES(MOV_ID,MOV_TITLE,MOV_YEAR,MOV_LANG,DIR_ID)VALUES("7","EE","1998","MAL","5");
INSERT INTO MOVIES(MOV_ID,MOV_TITLE,MOV_YEAR,MOV_LANG,DIR_ID)VALUES("8","FF","2020","MAL","4");
INSERT INTO MOVIES(MOV_ID,MOV_TITLE,MOV_YEAR,MOV_LANG,DIR_ID)VALUES("9","EE","2017","MAL","5");

INSERT INTO MOVIE_CAST(ACT_ID,MOV_ID,ROLE)VALUES("1","6","SAILOR");
INSERT INTO MOVIE_CAST(ACT_ID,MOV_ID,ROLE)VALUES("3","7","ENGINEER");
INSERT INTO MOVIE_CAST(ACT_ID,MOV_ID,ROLE)VALUES("2","8","CAPTAIN");
INSERT INTO MOVIE_CAST(ACT_ID,MOV_ID,ROLE)VALUES("12","9","COOK");


CREATE TABLE RATING(MOV_ID VARCHAR(20) NOT NULL,
                    REV_STARS INT(20) NOT NULL);
INSERT INTO RATING(MOV_ID,REV_STARS)VALUES("6","6");
INSERT INTO RATING(MOV_ID,REV_STARS)VALUES("7","10");
INSERT INTO RATING(MOV_ID,REV_STARS)VALUES("8","8");
INSERT INTO RATING(MOV_ID,REV_STARS)VALUES("9","9");


SELECT MOV_TITLE ,DIR_NAME
FROM MOVIES JOIN DIRECTOR ON
MOVIES.DIR_ID = DIRECTOR.DIR_ID
WHERE DIR_NAME="HITCHCOCK";
 
 

SELECT MOV_TITLE 
FROM MOVIES  JOIN ACTOR ON MOVIE_CAST.ACT_ID=ACTOR.ACT_ID
			JOIN MOVIES ON  MOVIE_CAST.MOV_ID=MOVIES.MOV_ID;
SELECT ACT_NAME,MOV_YEAR FROM ACTOR JOIN MOVIE_CAST ON MOVIE_CAST.ACT_ID =ACTOR.ACT_ID
							JOIN MOVIES ON MOVIE_CAST .MOV_ID=MOVIES.MOV_ID
                            
                            WHERE MOV_YEAR<2000 OR MOV_YEAR>2015;

	